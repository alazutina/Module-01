#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include <mkl.h>

void inverse(double* A, int N1) {
	lapack_int *IPIV = (lapack_int *)malloc(N1 * sizeof(lapack_int));
	int LWORK = N1*N1;

	int INFO;

	LAPACKE_dgetrf(LAPACK_ROW_MAJOR,N1,N1,A,N1,IPIV);
	LAPACKE_dgetri(LAPACK_ROW_MAJOR,N1,A,N1,IPIV);

	free(IPIV);

}

int main(){
    
int m;
m=4;
double p1,p2,p12,q1,q2,q12,pq12,pq21,r;
int i,j;


printf ("Enter probabilities:\n");
printf ("p1\n");
scanf ("%lf", &p1);
printf ("p2\n");
scanf ("%lf", &p2);
printf ("p12\n");
scanf ("%lf", &p12);
printf ("q1\n");
scanf ("%lf", &q1);
printf ("q2\n");
scanf ("%lf", &q2);
printf ("q12\n");
scanf ("%lf", &q12);
printf ("pq12\n");
scanf ("%lf", &pq12);
printf ("pq21\n");
scanf ("%lf", &pq21);
r = 1-p1-q1-p2-q2-p12-q12-pq12-pq21;



    double A [19*19];
    
    for (i=0; i<19; i++) {
        for (j=0; j<19; j++) {
            A[i*19+j]=0;
        }
        
    }

   // 1-я строка
   A[0*19+1]=p1+pq12;
   A[0*19+2]=p2+pq21;
   A[0*19+15]=p12;
   A[0*19+0]=q1+q2+q12+r;

   //2
   A[1*19+3]=p1;
   A[1*19+15]=p2+pq12;
   A[1*19+7]=p12;
   A[1*19+0]=q1+q12;
   A[1*19+2]=pq21;
   A[1*19+1]=r+q2;
   
   //3

   A[2*19+15]=p1+pq21;
   A[2*19+5]=p2;
   A[2*19+17]=p12;
   A[2*19+1]=pq12;
   A[2*19+0]=q2;
   A[2*19+2]=q1+q12+r;
   
   //4

   A[3*19+6]=p1;
   A[3*19+7]=p2+pq12;
   A[3*19+11]=p12;
   A[3*19+1]=q1+q12;
   A[3*19+15]=q2+pq21;
   A[3*19+3]=r;

   //5
   
   A[4*19+8]=p2;
   A[4*19+2]=q1;
   A[4*19+1]=q2;
   A[4*19+0]=q12;
   A[4*19+5]=pq21;
   A[4*19+4]=r;
   
   //6

   A[5*19+8]=p1+pq21;
   A[5*19+9]=p2;
   A[5*19+13]=p12;
   A[5*19+15]=q1;
   A[5*19+2]=q2;
   A[5*19+1]=q12;
   A[5*19+4]=pq12;
   A[5*19+5]=r;

   //7

   A[6*19+10]=p1;
   A[6*19+11]=p2+pq12;
  // A[6*19+16]=p12;
   A[6*19+3]=q1;
   A[6*19+7]=q2;
   A[6*19+15]=q12;
   A[6*19+16]=pq21;
   A[6*19+6]=r;

   //8

   A[7*19+12]=p2;
   A[7*19+15]=q1;
   A[7*19+5]=q2;
   A[7*19+1]=q12;
   A[7*19+17]=pq21;
   A[7*19+7]=r;
   
      //9

   A[8*19+13]=p2;
   A[8*19+5]=q1;
   A[8*19+4]=q2;
   A[8*19+2]=q12;
   A[8*19+9]=pq21;
   A[8*19+8]=r;
   
      //10

   A[9*19+13]=p1+pq21;
   A[9*19+14]=p2;
 // A[9*19+37]=p12;
   A[9*19+8]=q1+pq12;
   A[9*19+5]=q2;
   A[9*19+4]=q12;
   A[9*19+9]=r;


   //11

   //A[10*19+15]=p1;
   //A[10*19+16]=p2+pq12;
   //A[10*19+22]=p12;
   A[10*19+9]=q1;
   A[10*19+13]=q2;//+pq21;
   A[10*19+8]=q12;
   A[10*19+10]=r;
   

      //12

  // A[11*19+17]=p2;
   A[11*19+16]=q1;
   A[11*19+6]=q2;
   A[11*19+3]=q12;
  // A[11*19+32]=pq21;
   A[11*19+11]=r;
   
  //13

 //  A[12*19+18]=p2;
   A[12*19+17]=q1;
   A[12*19+7]=q2;
   A[12*19+15]=q12;
  // A[12*19+33]=pq21;
   A[12*19+12]=r;
   

  //14

  // A[13*19+19]=p2;
   A[13*19+9]=q1;
   A[13*19+8]=q2;
   A[13*19+5]=q12;
   //A[13*19+14]=pq21;
   A[13*19+13]=r;

    //15

 //  A[14*19+19]=p1+pq21;
  // A[14*19+20]=p2;
 //  A[14*19+26]=p12;
   A[14*19+13]=q1;
   A[14*19+9]=q2;
   A[14*19+8]=q12;
  // A[14*19+13]=pq12;
   A[14*19+14]=r;

    //16

   A[15*19+7]=p1;
   A[15*19+17]=p2;
     A[15*19+12]=p12;//+pq12;
   A[15*19+2]=q1;
   A[15*19+1]=q2;
   A[15*19+0]=q12;
     A[15*19+3]=pq12;
   A[15*19+5]=pq21;
   A[15*19+15]=r;

  //17

   A[16*19+11]=p1;
   A[16*19+18]=q1;
   A[16*19+3]=q2;
   A[16*19+1]=q12;
   A[16*19+9]=pq12;
   A[16*19+16]=r;

  //18

   A[17*19+12]=p1;
   A[17*19+5]=q1;
   A[17*19+15]=q2;
   A[17*19+2]=q12;
   A[17*19+7]=pq12;
   A[17*19+17]=r;

  //19

   A[18*19+16]=p1;
   A[18*19+2]=q1;
   A[18*19+1]=q2;
   A[18*19+0]=q12;
   A[18*19+4]=pq12;
   A[18*19+18]=r;   

   
   
    for (i=0; i<19; i++) {
 
        for (j=0; j<19; j++) {
          if(i==j){ A[i*19+j]=1-A[i*19+j];}
           else{A[i*19+j]=0-A[i*19+j];}
    
            
        }

        
    }

    inverse(A, 19);
    

    
    double t;
    t=0;

 
   
        for (i=0; i<19; i++) {
            t=t+A[0*19+i];
            
         
        }
        
  
    printf("t = %f\n", t);


    return 0;
}
