#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include <mkl.h>

void inverse(double* A, int N1) {
	lapack_int *IPIV = (lapack_int *)malloc(N1 * sizeof(lapack_int));
	int LWORK = N1*N1;

	int INFO;

	LAPACKE_dgetrf(LAPACK_ROW_MAJOR,N1,N1,A,N1,IPIV);
	LAPACKE_dgetri(LAPACK_ROW_MAJOR,N1,A,N1,IPIV);

	free(IPIV);

}

int main(){
    
int m;
m=6;
double p1,p2,p12,q1,q2,q12,pq12,pq21,r;
int i,j;


printf ("Enter probabilities:\n");
printf ("p1\n");
scanf ("%lf", &p1);
printf ("p2\n");
scanf ("%lf", &p2);
printf ("p12\n");
scanf ("%lf", &p12);
printf ("q1\n");
scanf ("%lf", &q1);
printf ("q2\n");
scanf ("%lf", &q2);
printf ("q12\n");
scanf ("%lf", &q12);
printf ("pq12\n");
scanf ("%lf", &pq12);
printf ("pq21\n");
scanf ("%lf", &pq21);
r = 1-p1-q1-p2-q2-p12-q12-pq12-pq21;



    double A [48*48];
    
    for (i=0; i<48; i++) {
        for (j=0; j<48; j++) {
            A[i*48+j]=0;
        }
        
    }

   // 1-я строка
   A[0*48+1]=p1+pq12;
   A[0*48+2]=p2+pq21;
   A[0*48+38]=p12;
   A[0*48+0]=q1+q2+q12+r;

   //2
   A[1*48+3]=p1;
   A[1*48+38]=p2+pq12;
   A[1*48+29]=p12;
   A[1*48+0]=q1+q12;
   A[1*48+2]=pq21;
   A[1*48+1]=r+q2;
   
   //3

   A[2*48+38]=p1+pq21;
   A[2*48+5]=p2;
   A[2*48+40]=p12;
   A[2*48+1]=pq12;
   A[2*48+0]=q2;
   A[2*48+2]=q1+q12+r;
   
   //4

   A[3*48+6]=p1;
   A[3*48+29]=p2+pq12;
   A[3*48+31]=p12;
   A[3*48+1]=q1+q12;
   A[3*48+38]=q2+pq21;
   A[3*48+3]=r;

   //5
   
   A[4*48+8]=p2;
   A[4*48+2]=q1;
   A[4*48+1]=q2;
   A[4*48+0]=q12;
   A[4*48+5]=pq21;
   A[4*48+4]=r;
   
   //6

   A[5*48+30]=p1+pq21;
   A[5*48+9]=p2;
   A[5*48+33]=p12;
   A[5*48+38]=q1;
   A[5*48+2]=q2;
   A[5*48+1]=q12;
   A[5*48+28]=pq12;
   A[5*48+5]=r;

   //7

   A[6*48+10]=p1;
   A[6*48+31]=p2+pq12;
   A[6*48+16]=p12;
   A[6*48+3]=q1;
   A[6*48+29]=q2;
   A[6*48+38]=q12;
   A[6*48+39]=pq21;
   A[6*48+6]=r;

   //8

   A[7*48+12]=p2;
   A[7*48+28]=q1;
   A[7*48+3]=q2;
   A[7*48+1]=q12;
   A[7*48+30]=pq21;
   A[7*48+7]=r;
   
      //9

   A[8*48+13]=p2;
   A[8*48+5]=q1;
   A[8*48+4]=q2;
   A[8*48+2]=q12;
   A[8*48+9]=pq21;
   A[8*48+8]=r;
   
      //10

   A[9*48+33]=p1+pq21;
   A[9*48+14]=p2;
   A[9*48+37]=p12;
   A[9*48+30]=q1+pq12;
   A[9*48+5]=q2;
   A[9*48+28]=q12;
   A[9*48+9]=r;


   //11

   A[10*48+15]=p1;
   A[10*48+16]=p2+pq12;
   A[10*48+22]=p12;
   A[10*48+6]=q1;
   A[10*48+31]=q2+pq21;
   A[10*48+29]=q12;
   A[10*48+10]=r;
   

      //12

   A[11*48+17]=p2;
   A[11*48+29]=q1;
   A[11*48+6]=q2;
   A[11*48+3]=q12;
   A[11*48+32]=pq21;
   A[11*48+11]=r;
   
  //13

   A[12*48+18]=p2;
   A[12*48+30]=q1;
   A[12*48+7]=q2;
   A[12*48+28]=q12;
   A[12*48+33]=pq21;
   A[12*48+12]=r;
   

  //14

   A[13*48+19]=p2;
   A[13*48+9]=q1;
   A[13*48+8]=q2;
   A[13*48+5]=q12;
   A[13*48+14]=pq21;
   A[13*48+13]=r;

    //15

   A[14*48+19]=p1+pq21;
   A[14*48+20]=p2;
   A[14*48+26]=p12;
   A[14*48+33]=q1;
   A[14*48+9]=q2;
   A[14*48+30]=q12;
   A[14*48+13]=pq12;
   A[14*48+14]=r;

    //16

   A[15*48+21]=p1;
   A[15*48+22]=p2+pq12;
   A[15*48+10]=q1;
   A[15*48+16]=q2;
   A[15*48+31]=q12;
   A[15*48+34]=pq21;
   A[15*48+15]=r;

  //17

   A[16*48+23]=p2;
   A[16*48+31]=q1;
   A[16*48+10]=q2;
   A[16*48+6]=q12;
   A[16*48+35]=pq21;
   A[16*48+16]=r;

  //18

   A[17*48+24]=p2;
   A[17*48+32]=q1;
   A[17*48+11]=q2;
   A[17*48+29]=q12;
   A[17*48+36]=pq21;
   A[17*48+17]=r;

  //19

   A[18*48+25]=p2;
   A[18*48+33]=q1;
   A[18*48+12]=q2;
   A[18*48+30]=q12;
   A[18*48+37]=pq21;
   A[18*48+18]=r;   

   
  //20

   A[19*48+26]=p2;
   A[19*48+14]=q1;
   A[19*48+13]=q2;
   A[19*48+9]=q12;
   A[19*48+20]=pq21;
   A[19*48+19]=r;   

   //21

   A[20*48+26]=p1+pq21;
   A[20*48+27]=p2;
   A[20*48+19]=q1+pq12;
   A[20*48+14]=q2;
   A[20*48+13]=q12;
   A[20*48+20]=r;

  //22

   A[21*48+15]=q1;
   A[21*48+22]=q2;
   A[21*48+16]=q12;
   A[21*48+21]=r;  

    //23

   A[22*48+34]=q1;
   A[22*48+15]=q2;
   A[22*48+10]=q12;
   A[22*48+22]=r; 
   
       //24

   A[23*48+35]=q1;
   A[23*48+16]=q2;
   A[23*48+31]=q12;
   A[23*48+23]=r; 
   
       //25

   A[24*48+36]=q1;
   A[24*48+17]=q2;
   A[24*48+32]=q12;
   A[24*48+24]=r; 
   
       //26

   A[25*48+37]=q1;
   A[25*48+18]=q2;
   A[25*48+33]=q12;
   A[25*48+25]=r;
   
          //27

   A[26*48+20]=q1;
   A[26*48+19]=q2;
   A[26*48+14]=q12;
   A[26*48+26]=r;

      
          //28

   A[27*48+26]=q1;
   A[27*48+20]=q2;
   A[27*48+19]=q12;
   A[27*48+27]=r;

   //29
   A[28*48+7]=p1;
   A[28*48+30]=p2;
   A[28*48+12]=p12;
   A[28*48+2]=q1;
   A[28*48+1]=q2;
   A[28*48+0]=q12;
   A[28*48+3]=pq12;
   A[28*48+5]=pq21;
   A[28*48+28]=r;
   
  //30
   A[29*48+11]=p1;
   A[29*48+32]=p2;
   A[29*48+17]=p12;
   A[29*48+38]=q1;
   A[29*48+3]=q2;
   A[29*48+1]=q12;
   A[29*48+6]=pq12;
   A[29*48+40]=pq21;
   A[29*48+29]=r;
    
  //31
   A[30*48+12]=p1;
   A[30*48+33]=p2;
   A[30*48+18]=p12;
   A[30*48+5]=q1;
   A[30*48+28]=q2;
   A[30*48+2]=q12;
   A[30*48+7]=pq12;
   A[30*48+9]=pq21;
   A[30*48+30]=r;
   
     //32
   A[31*48+16]=p1;
   A[31*48+35]=p2;
   A[31*48+23]=p12;
   A[31*48+39]=q1;
   A[31*48+6]=q2;
   A[31*48+3]=q12;
   A[31*48+10]=pq12;
   A[31*48+42]=pq21;
   A[31*48+31]=r;
   
        //33
   A[32*48+17]=p1;
   A[32*48+36]=p2;
   A[32*48+24]=p12;
   A[32*48+40]=q1;
   A[32*48+29]=q2;
   A[32*48+38]=q12;
   A[32*48+11]=pq12;
   A[32*48+43]=pq21;
   A[32*48+32]=r;
   
        //34
   A[33*48+18]=p1;
   A[33*48+37]=p2;
   A[33*48+25]=p12;
   A[33*48+9]=q1;
   A[33*48+30]=q2;
   A[33*48+5]=q12;
   A[33*48+12]=pq12;
   A[33*48+14]=pq21;
   A[33*48+33]=r;

      //35
   A[34*48+22]=p1;
   A[34*48+41]=q1;
   A[34*48+10]=q2;
   A[34*48+6]=q12;
   A[34*48+15]=pq12;
   A[34*48+34]=r;

      //36
   A[35*48+23]=p1;
   A[35*48+42]=q1;
   A[35*48+31]=q2;
   A[35*48+39]=q12;
   A[35*48+16]=pq12;
   A[35*48+35]=r;
   
         //37
   A[36*48+24]=p1;
   A[36*48+43]=q1;
   A[36*48+32]=q2;
   A[36*48+40]=q12;
   A[36*48+17]=pq12;
   A[36*48+36]=r;
   
         //38
   A[37*48+25]=p1;
   A[37*48+14]=q1;
   A[37*48+33]=q2;
   A[37*48+9]=q12;
   A[37*48+18]=pq12;
   A[37*48+37]=r;
   
        //39
   A[38*48+29]=p1;
   A[38*48+40]=p2;
   A[38*48+32]=p12;
   A[38*48+2]=q1;
   A[38*48+1]=q2;
   A[38*48+0]=q12;
   A[38*48+3]=pq12;
   A[38*48+5]=pq21;
   A[38*48+38]=r;
   
        //40
   A[39*48+31]=p1;
   A[39*48+42]=p2;
   A[39*48+35]=p12;
   A[39*48+44]=q1;
   A[39*48+3]=q2;
   A[39*48+1]=q12;
   A[39*48+6]=pq12;
   A[39*48+46]=pq21;
   A[39*48+39]=r;

       //41
   A[40*48+32]=p1;
   A[40*48+43]=p2;
   A[40*48+36]=p12;
   A[40*48+5]=q1;
   A[40*48+38]=q2;
   A[40*48+2]=q12;
   A[40*48+29]=pq12;
   A[40*48+9]=pq21;
   A[40*48+40]=r;


       //42
   A[41*48+34]=p1;
   A[41*48+45]=q1;
   A[41*48+6]=q2;
   A[41*48+3]=q12;
   A[41*48+10]=pq12;
   A[41*48+41]=r;


       //43
   A[42*48+35]=p1;
   A[42*48+46]=q1;
   A[42*48+39]=q2;
   A[42*48+44]=q12;
   A[42*48+31]=pq12;
   A[42*48+42]=r;


       //44
   A[43*48+36]=p1;
   A[43*48+9]=q1;
   A[43*48+40]=q2;
   A[43*48+5]=q12;
   A[43*48+32]=pq12;
   A[43*48+43]=r;

        //45
   A[44*48+39]=p1;
   A[44*48+46]=p2;
   A[44*48+42]=p12;
   A[44*48+2]=q1;
   A[44*48+1]=q2;
   A[44*48+0]=q12;
   A[44*48+3]=pq12;
   A[44*48+5]=pq21;
   A[44*48+44]=r;
  
   

       //46
   A[45*48+41]=p1;
   A[45*48+47]=q1;
   A[45*48+3]=q2;
   A[45*48+1]=q12;
   A[45*48+6]=pq12;
   A[45*48+45]=r;


       //47
   A[46*48+42]=p1;
   A[46*48+5]=q1;
   A[46*48+44]=q2;
   A[46*48+2]=q12;
   A[46*48+39]=pq12;
   A[46*48+46]=r;


       //48
   A[47*48+45]=p1;
   A[47*48+2]=q1;
   A[47*48+1]=q2;
   A[47*48+0]=q12;
   A[47*48+3]=pq12;
   A[47*48+47]=r;
   
    for (i=0; i<48; i++) {

        for (j=0; j<48; j++) {
          if(i==j){ A[i*48+j]=1-A[i*48+j];}
           else{A[i*48+j]=0-A[i*48+j];}

            
        }

        
    }

    inverse(A, 48);
    

    
    double t;
    t=0;


   
        for (i=0; i<48; i++) {
            t=t+A[0*48+i];
         
        }
        
  
    printf("t = %f\n", t);


    return 0;
}
