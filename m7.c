#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include <mkl.h>

void inverse(double* A, int N1) {
	lapack_int *IPIV = (lapack_int *)malloc(N1 * sizeof(lapack_int));
	int LWORK = N1*N1;

	int INFO;

	LAPACKE_dgetrf(LAPACK_ROW_MAJOR,N1,N1,A,N1,IPIV);
	LAPACKE_dgetri(LAPACK_ROW_MAJOR,N1,A,N1,IPIV);

	free(IPIV);

}

int main(){
    
int m;
m=6;
double p1,p2,p12,q1,q2,q12,pq12,pq21,r;
int i,j;


printf ("Enter probabilities:\n");
printf ("p1\n");
scanf ("%lf", &p1);
printf ("p2\n");
scanf ("%lf", &p2);
printf ("p12\n");
scanf ("%lf", &p12);
printf ("q1\n");
scanf ("%lf", &q1);
printf ("q2\n");
scanf ("%lf", &q2);
printf ("q12\n");
scanf ("%lf", &q12);
printf ("pq12\n");
scanf ("%lf", &pq12);
printf ("pq21\n");
scanf ("%lf", &pq21);
r = 1-p1-q1-p2-q2-p12-q12-pq12-pq21;



    double A [71*71];
    
    for (i=0; i<71; i++) {
        for (j=0; j<71; j++) {
            A[i*71+j]=0;
        }
        
    }

   // 1-я строка
   A[0*71+1]=p1+pq12;
   A[0*71+2]=p2+pq21;
   A[0*71+51]=p12;
   A[0*71+0]=q1+q2+q12+r;

   //2
   A[1*71+3]=p1;
   A[1*71+51]=p2+pq12;
   A[1*71+52]=p12;
   A[1*71+0]=q1+q12;
   A[1*71+2]=pq21;
   A[1*71+1]=r+q2;
   
   //3

   A[2*71+51]=p1+pq21;
   A[2*71+5]=p2;
   A[2*71+53]=p12;
   A[2*71+1]=pq12;
   A[2*71+0]=q2+q12;
   A[2*71+2]=q1+r;
   
   //4

   A[3*71+6]=p1;
   A[3*71+52]=p2+pq12;
   A[3*71+39]=p12;
   A[3*71+1]=q1+q12;
   A[3*71+51]=q2;
   A[3*71+61]=pq21;
   A[3*71+3]=r;

   //5
   
   A[4*71+8]=p2;
   A[4*71+2]=q1;
   A[4*71+1]=q2;
   A[4*71+0]=q12;
   A[4*71+5]=pq21;
   A[4*71+4]=r;
   
   //6

   A[5*71+53]=p1+pq21;
   A[5*71+9]=p2;
   A[5*71+56]=p12;
   A[5*71+51]=q1+pq12;
   A[5*71+2]=q2;
   A[5*71+28]=pq12;
   A[5*71+5]=r;

   //7

   A[6*71+10]=p1;
   A[6*71+31]=p2+pq12;
   A[6*71+42]=p12;
   A[6*71+3]=q1;
   A[6*71+52]=q2+pq21;
   A[6*71+51]=q12;
   A[6*71+6]=r;

   //8

   A[7*71+12]=p2;
   A[7*71+36]=q1;
   A[7*71+3]=q2;
   A[7*71+1]=q12;
   A[7*71+38]=pq21;
   A[7*71+7]=r;
   
      //9

   A[8*71+13]=p2;
   A[8*71+5]=q1;
   A[8*71+4]=q2;
   A[8*71+2]=q12;
   A[8*71+9]=pq21;
   A[8*71+8]=r;
   
      //10

   A[9*71+41]=p1+pq21;
   A[9*71+14]=p2;
   A[9*71+45]=p12;
   A[9*71+53]=q1;
   A[9*71+5]=q2;
   A[9*71+38]=pq12;
   A[9*71+9]=r;


   //11

   A[10*71+15]=p1;
   A[10*71+42]=p2+pq12;
   A[10*71+22]=p12;
   A[10*71+6]=q1;
   A[10*71+39]=q2;
   A[10*71+54]=pq21;
   A[10*71+52]=q12;
   A[10*71+10]=r;
   

      //12

   A[11*71+17]=p2;
   A[11*71+37]=q1;
   A[11*71+6]=q2;
   A[11*71+3]=q12;
   A[11*71+40]=pq21;
   A[11*71+11]=r;
   
  //13

   A[12*71+18]=p2;
   A[12*71+38]=q1;
   A[12*71+7]=q2;
   A[12*71+36]=q12;
   A[12*71+41]=pq21;
   A[12*71+12]=r;
   

  //14

   A[13*71+19]=p2;
   A[13*71+9]=q1;
   A[13*71+8]=q2;
   A[13*71+5]=q12;
   A[13*71+14]=pq21;
   A[13*71+13]=r;

    //15

   A[14*71+45]=p1+pq21;
   A[14*71+20]=p2;
   A[14*71+50]=p12;
   A[14*71+41]=q1;
   A[14*71+9]=q2;
   A[14*71+38]=q12;
   A[14*71+41]=pq12;
   A[14*71+14]=r;

    //16

   A[15*71+21]=p1;
   A[15*71+22]=p2+pq12;
   A[15*71+29]=p12;
   A[15*71+10]=q1;
   A[15*71+42]=q2;
   A[15*71+39]=q12;
   A[15*71+42]=pq21;
   A[15*71+15]=r;

  //17

   A[16*71+23]=p2;
   A[16*71+39]=q1;
   A[16*71+10]=q2;
   A[16*71+6]=q12;
   A[16*71+44]=pq21;
   A[16*71+16]=r;

  //18

   A[17*71+24]=p2;
   A[17*71+40]=q1;
   A[17*71+11]=q2;
   A[17*71+37]=q12;
   A[17*71+44]=pq21;
   A[17*71+17]=r;

  //19

   A[18*71+25]=p2;
   A[18*71+41]=q1;
   A[18*71+12]=q2;
   A[18*71+38]=q12;
   A[18*71+45]=pq21;
   A[18*71+18]=r;   

   
  //20

   A[19*71+26]=p2;
   A[19*71+14]=q1;
   A[19*71+13]=q2;
   A[19*71+9]=q12;
   A[19*71+20]=pq21;
   A[19*71+19]=r;   

   //21

   A[20*71+26]=p1+pq21;
   A[20*71+27]=p2;
   A[20*71+34]=p12;
   A[20*71+45]=q1;
   A[20*71+14]=q2;
   A[20*71+41]=q12;
   A[20*71+19]=pq12;
   A[20*71+20]=r;

  //22

   A[21*71+28]=p1;
   A[21*71+29]=p2+pq12;
   A[21*71+15]=q1;
   A[21*71+22]=q2;
   A[21*71+45]=q12;
   A[21*71+46]=pq21;
   A[21*71+21]=r;  

    //23
   A[22*71+30]=p2;
   A[22*71+42]=q1;
   A[22*71+15]=q2;
   A[22*71+10]=q12;
   A[22*71+47]=pq21;
   A[22*71+22]=r; 
   
       //24
   A[23*71+31]=p2;
   A[23*71+43]=q1;
   A[23*71+16]=q2;
   A[23*71+39]=q12;
      A[23*71+48]=pq21;
   A[23*71+23]=r; 
   
       //25
   A[24*71+32]=p2;
   A[24*71+44]=q1;
   A[24*71+17]=q2;
   A[24*71+40]=q12;
    A[24*71+49]=pq21;
   A[24*71+24]=r; 
   
       //26
   A[25*71+33]=p2;
   A[25*71+45]=q1;
   A[25*71+18]=q2;
   A[25*71+41]=q12;
       A[25*71+50]=pq21;
   A[25*71+25]=r;
   
          //27
  A[26*71+34]=p2;
   A[26*71+20]=q1;
   A[26*71+19]=q2;
   A[26*71+14]=q12;
         A[26*71+27]=pq21;
   A[26*71+26]=r;

      
          //28
  A[27*71+34]=p1;
   A[27*71+35]=p2;
   A[27*71+26]=q1;
   A[27*71+20]=q2;
   A[27*71+19]=q12;
     A[27*71+26]=pq12;
   A[27*71+34]=pq21;
   A[27*71+27]=r;

   //29

   A[28*71+21]=q1;
   A[28*71+29]=q2;
   A[28*71+22]=q12;

   A[28*71+28]=r;
   
  //30

   A[29*71+46]=q1;
   A[29*71+21]=q2;
   A[29*71+15]=q12;

   A[29*71+29]=r;
    
  //31

   A[30*71+47]=q1;
   A[30*71+22]=q2;
   A[30*71+43]=q12;

   A[30*71+30]=r;
   
     //32

   A[31*71+48]=q1;
   A[31*71+23]=q2;
   A[31*71+43]=q12;

   A[31*71+31]=r;
   
        //33

   A[32*71+49]=q1;
   A[32*71+24]=q2;
   A[32*71+44]=q12;

   A[32*71+32]=r;
   
        //34

   A[33*71+50]=q1;
   A[33*71+25]=q2;
   A[33*71+45]=q12;

   A[33*71+33]=r;

      //35

   A[34*71+27]=q1;
   A[34*71+26]=q2;
   A[34*71+20]=q12;
   A[34*71+34]=r;

      //36

   A[35*71+34]=q1;
   A[35*71+27]=q2;
   A[35*71+26]=q12;

   A[35*71+35]=r;
   
         //37
   A[36*71+7]=p1;
   A[36*71+38]=p2;
     A[36*71+12]=p12; 
   A[36*71+2]=q1;
   A[36*71+1]=q2;
   A[36*71+0]=q12;
    A[36*71+3]=pq12;
   A[36*71+5]=pq21;
   A[36*71+36]=r;
   
         //38
   A[37*71+11]=p1;
   A[37*71+40]=p2;
   A[37*71+17]=p12;
   A[37*71+51]=q1;
   A[37*71+3]=q2;
   A[37*71+1]=q12;
   A[37*71+53]=pq21;
   A[37*71+6]=pq12;
   A[37*71+37]=r;
   
        //39
   A[38*71+12]=p1;
   A[38*71+41]=p2;
   A[38*71+18]=p12;
   A[38*71+5]=q1;
   A[38*71+36]=q2;
   A[38*71+2]=q12;
   A[38*71+7]=pq12;
   A[38*71+9]=pq21;
   A[38*71+38]=r;
   
        //40
   A[39*71+16]=p1;
   A[39*71+43]=p2;
   A[39*71+23]=p12;
   A[39*71+52]=q1;
   A[39*71+6]=q2;
   A[39*71+3]=q12;
   A[39*71+10]=pq12;
   A[39*71+55]=pq21;
   A[39*71+39]=r;

       //41
   A[40*71+17]=p1;
   A[40*71+44]=p2;
   A[40*71+24]=p12;
   A[40*71+53]=q1;
   A[40*71+37]=q2;
   A[40*71+51]=q12;
   A[40*71+11]=pq12;
   A[40*71+56]=pq21;
   A[40*71+40]=r;


       //42
   A[41*71+18]=p1;
      A[41*71+45]=p2;
         A[41*71+25]=p12;
   A[41*71+9]=q1;
   A[41*71+38]=q2;
   A[41*71+5]=q12;
      A[41*71+14]=pq21;
   A[41*71+12]=pq12;
   A[41*71+41]=r;


       //43
   A[42*71+22]=p1;
     A[42*71+47]=p1;
       A[42*71+30]=p1;
   A[42*71+54]=q1;
   A[42*71+10]=q2;
   A[42*71+6]=q12;
   A[42*71+15]=pq12;
      A[42*71+58]=pq21;
   A[42*71+42]=r;


       //44
   A[43*71+23]=p1;
      A[43*71+48]=p2;
         A[43*71+31]=p12;
   A[43*71+55]=q1;
   A[43*71+39]=q2;
   A[43*71+52]=q12;
   
   A[43*71+16]=pq12;
      A[43*71+59]=pq21;
   A[43*71+43]=r;

        //45
   A[44*71+24]=p1;
   A[44*71+49]=p2;
   A[44*71+32]=p12;
   A[44*71+56]=q1;
   A[44*71+40]=q2;
   A[44*71+53]=q12;
   A[44*71+17]=pq12;
   A[44*71+60]=pq21;
   A[44*71+44]=r;
  
   

       //46
   A[45*71+25]=p1;
      A[45*71+50]=p2;
         A[45*71+33]=p12;
   A[45*71+14]=q1;
   A[45*71+41]=q2;
   A[45*71+9]=q12;
      A[45*71+18]=pq12;
   A[45*71+20]=pq21;
   A[45*71+45]=r;


       //47
   A[46*71+29]=p1;
 
   A[46*71+57]=q1;
   A[46*71+15]=q2;
   A[46*71+10]=q12;
   A[46*71+21]=pq12;

   A[46*71+46]=r;


       //48
   A[47*71+30]=p1;
   A[47*71+58]=q1;
   A[47*71+42]=q2;
   A[47*71+54]=q12;
   A[47*71+22]=pq12;
   A[47*71+47]=r;
   
         //49
   A[48*71+31]=p1;
   A[48*71+59]=q1;
   A[48*71+43]=q2;
   A[48*71+55]=q12;
   A[48*71+23]=pq12;
   A[48*71+48]=r;
   
           //50
   A[49*71+32]=p1;
   A[49*71+60]=q1;
   A[49*71+44]=q2;
   A[49*71+56]=q12;
   A[49*71+24]=pq12;
   A[49*71+49]=r;
   
              //51
   A[50*71+33]=p1;
   A[50*71+20]=q1;
   A[50*71+45]=q2;
   A[50*71+14]=q12;
   A[50*71+25]=pq12;
   A[50*71+50]=r;
   
   
                 //52
   A[51*71+37]=p1;
      A[51*71+53]=p2;
         A[51*71+40]=p12;
   A[51*71+2]=q1;
   A[51*71+1]=q2;
   A[51*71+0]=q12;
      A[51*71+3]=pq12;
   A[51*71+5]=pq21;
   A[51*71+51]=r;
   
                    //53
   A[52*71+39]=p1;
      A[52*71+55]=p2;
         A[52*71+43]=p12;
   A[52*71+61]=q1;
   A[52*71+3]=q2;
   A[52*71+1]=q12;
      A[52*71+6]=pq12;
   A[52*71+63]=pq21;
   A[52*71+52]=r;
   
                       //54
   A[53*71+40]=p1;
      A[53*71+56]=p2;
         A[53*71+44]=p12;
   A[53*71+5]=q1;
   A[53*71+51]=q2;
   A[53*71+2]=q12;
      A[53*71+37]=pq12;
   A[53*71+9]=pq21;
   A[53*71+53]=r;
   
                          //55
   A[54*71+42]=p1;
      A[54*71+58]=p2;
         A[54*71+47]=p12;
   A[54*71+62]=q1;
   A[54*71+6]=q2;
   A[54*71+3]=q12;
      A[54*71+10]=pq12;
   A[54*71+65]=pq21;
   A[54*71+54]=r;
      
                          //56
   A[55*71+43]=p1;
      A[55*71+59]=p2;
         A[55*71+48]=p12;
   A[55*71+66]=q1;
   A[55*71+52]=q2;
   A[55*71+61]=q12;
      A[55*71+39]=pq12;
   A[55*71+66]=pq21;
   A[55*71+55]=r;
 
                             //57
   A[56*71+44]=p1;
      A[56*71+60]=p2;
         A[56*71+49]=p12;
   A[56*71+9]=q1;
   A[56*71+53]=q2;
   A[56*71+5]=q12;
      A[56*71+40]=pq12;
   A[56*71+14]=pq21;
   A[56*71+56]=r;
   
    
                             //58
   A[57*71+46]=p1;
     
   A[57*71+64]=q1;
   A[57*71+10]=q2;
   A[57*71+6]=q12;
      
   A[57*71+15]=pq12;
   A[57*71+57]=r;
   
                                //59
   A[58*71+47]=p1;
     
   A[58*71+65]=q1;
   A[58*71+54]=q2;
   A[58*71+62]=q12;
      
   A[58*71+42]=pq12;
   A[58*71+58]=r;
   
                                   //60
   A[59*71+48]=p1;
     
   A[59*71+66]=q1;
   A[59*71+55]=q2;
   A[59*71+63]=q12;
      
   A[59*71+43]=pq12;
   A[58*71+58]=r;
   
   
                                      //61
   A[60*71+49]=p1;
     
   A[60*71+15]=q1;
   A[60*71+56]=q2;
   A[60*71+9]=q12;
      
   A[60*71+44]=pq12;
   A[60*71+60]=r;
   
   
      
                                      //62
   A[61*71+52]=p1;
      A[61*71+63]=p2;
         A[61*71+55]=p12;
     
   A[61*71+2]=q1;
   A[61*71+1]=q2;
   A[61*71+0]=q12;
      
   A[61*71+3]=pq12;
       
   A[61*71+5]=pq21;
   A[61*71+61]=r;
   
                                         //63
   A[62*71+54]=p1;
      A[62*71+65]=p2;
         A[62*71+58]=p12;
     
   A[62*71+67]=q1;
   A[62*71+3]=q2;
   A[62*71+1]=q12;
      
   A[62*71+6]=pq12;
       
   A[62*71+69]=pq21;
   A[62*71+62]=r;
   
   
                                            //64
   A[63*71+55]=p1;
      A[63*71+66]=p2;
         A[63*71+59]=p12;
     
   A[63*71+5]=q1;
   A[63*71+61]=q2;
   A[63*71+2]=q12;
      
   A[63*71+52]=pq12;
       
   A[63*71+9]=pq21;
   A[63*71+63]=r;
   
                                              //65
   A[64*71+57]=p1;
       A[64*71+68]=q1;
   A[64*71+6]=q2;
   A[64*71+3]=q12;
         A[64*71+10]=pq12;
          A[64*71+64]=r;
          
                                                        //66
   A[65*71+58]=p1;
       A[65*71+69]=q1;
   A[65*71+62]=q2;
   A[65*71+67]=q12;
         A[65*71+54]=pq12;
          A[65*71+65]=r;
   
          
                                                                 //67
   A[66*71+59]=p1;
       A[66*71+9]=q1;
   A[66*71+63]=q2;
   A[66*71+5]=q12;
         A[66*71+55]=pq12;
          A[66*71+66]=r;
   
                    
                                                                 //68
   A[67*71+62]=p1;
     A[67*71+69]=p2;
       A[67*71+65]=p12;
       A[67*71+2]=q1;
   A[67*71+1]=q2;
   A[67*71+0]=q12;
         A[67*71+3]=pq12;
               A[67*71+5]=pq12;
          A[67*71+67]=r;
   
                                                                         //69
   A[68*71+64]=p1;
       A[68*71+70]=q1;
   A[68*71+3]=q2;
   A[68*71+1]=q12;
         A[68*71+6]=pq12;
          A[68*71+68]=r;
                                                                          //70
   A[69*71+65]=p1;
       A[69*71+5]=q1;
   A[69*71+61]=q2;
   A[69*71+2]=q12;
         A[69*71+62]=pq12;
          A[69*71+69]=r;         
          
                                                                           //71
   A[70*71+68]=p1;
       A[70*71+2]=q1;
   A[70*71+1]=q2;
   A[70*71+0]=q12;
         A[70*71+3]=pq12;
          A[70*71+70]=r;   
          
          
    for (i=0; i<71; i++) {

        for (j=0; j<71; j++) {
          if(i==j){ A[i*71+j]=1-A[i*71+j];}
           else{A[i*71+j]=0-A[i*71+j];}
   
            
        }

        
    }

    inverse(A, 71);
    

    
    double t;
    t=0;


   
        for (i=0; i<71; i++) {
            t=t+A[0*71+i];

        }
        
  
    printf("t = %f\n", t);


    return 0;
}
